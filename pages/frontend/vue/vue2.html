<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>没想好</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/egg.png">
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.efec8a6d.css" as="style"><link rel="preload" href="/assets/js/app.824c4530.js" as="script"><link rel="preload" href="/assets/js/2.043a423b.js" as="script"><link rel="preload" href="/assets/js/14.edf7d5e1.js" as="script"><link rel="prefetch" href="/assets/js/10.9999ba99.js"><link rel="prefetch" href="/assets/js/11.cf4c37ac.js"><link rel="prefetch" href="/assets/js/12.a2f0bc1c.js"><link rel="prefetch" href="/assets/js/13.0a766736.js"><link rel="prefetch" href="/assets/js/15.5fa85732.js"><link rel="prefetch" href="/assets/js/16.a6738b34.js"><link rel="prefetch" href="/assets/js/17.81f5c19d.js"><link rel="prefetch" href="/assets/js/3.d9bc2229.js"><link rel="prefetch" href="/assets/js/4.db16b84d.js"><link rel="prefetch" href="/assets/js/5.ce22f85c.js"><link rel="prefetch" href="/assets/js/6.078ab10c.js"><link rel="prefetch" href="/assets/js/7.c5848028.js"><link rel="prefetch" href="/assets/js/8.7273b2bd.js"><link rel="prefetch" href="/assets/js/9.5b8597d9.js">
    <link rel="stylesheet" href="/assets/css/0.styles.efec8a6d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/egg.png" alt="没想好" class="logo"> <span class="site-name can-hide">没想好</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/frontend/react/classAndFunction.html" class="nav-link">
  react
</a></li><li class="dropdown-item"><!----> <a href="/pages/frontend/vue/vue2.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  vue
</a></li><li class="dropdown-item"><!----> <a href="/pages/frontend/js/replace.html" class="nav-link">
  js
</a></li><li class="dropdown-item"><!----> <a href="/pages/frontend/css/white-spaceAndword-break.html" class="nav-link">
  css
</a></li><li class="dropdown-item"><!----> <a href="/pages/frontend/vuepress/vuepress.html" class="nav-link">
  vuepress
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="后端" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/backend/nodejs/test.html" class="nav-link">
  nodejs
</a></li></ul></div></div><div class="nav-item"><a href="/pages/life/test.html" class="nav-link">
  生活记录
</a></div><div class="nav-item"><a href="https://github.com/123456wjw" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/frontend/react/classAndFunction.html" class="nav-link">
  react
</a></li><li class="dropdown-item"><!----> <a href="/pages/frontend/vue/vue2.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  vue
</a></li><li class="dropdown-item"><!----> <a href="/pages/frontend/js/replace.html" class="nav-link">
  js
</a></li><li class="dropdown-item"><!----> <a href="/pages/frontend/css/white-spaceAndword-break.html" class="nav-link">
  css
</a></li><li class="dropdown-item"><!----> <a href="/pages/frontend/vuepress/vuepress.html" class="nav-link">
  vuepress
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="后端" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/backend/nodejs/test.html" class="nav-link">
  nodejs
</a></li></ul></div></div><div class="nav-item"><a href="/pages/life/test.html" class="nav-link">
  生活记录
</a></div><div class="nav-item"><a href="https://github.com/123456wjw" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>react</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>vue</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/frontend/vue/vue2.html" aria-current="page" class="active sidebar-link">vue2</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/frontend/vue/vue2.html#响应式原理" class="sidebar-link">响应式原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/frontend/vue/vue2.html#什么是响应式" class="sidebar-link">什么是响应式</a></li><li class="sidebar-sub-header"><a href="/pages/frontend/vue/vue2.html#object-defineproperty" class="sidebar-link">Object.defineProperty</a></li><li class="sidebar-sub-header"><a href="/pages/frontend/vue/vue2.html#vue响应式原理" class="sidebar-link">vue响应式原理</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/frontend/vue/vue2.html#计算属性computed" class="sidebar-link">计算属性computed</a></li><li class="sidebar-sub-header"><a href="/pages/frontend/vue/vue2.html#v-for列表循环key属性" class="sidebar-link">v-for列表循环key属性</a></li><li class="sidebar-sub-header"><a href="/pages/frontend/vue/vue2.html#动态修改数组与对象" class="sidebar-link">动态修改数组与对象</a></li><li class="sidebar-sub-header"><a href="/pages/frontend/vue/vue2.html#修饰符" class="sidebar-link">修饰符</a></li><li class="sidebar-sub-header"><a href="/pages/frontend/vue/vue2.html#vue单元测试" class="sidebar-link">vue单元测试</a></li><li class="sidebar-sub-header"><a href="/pages/frontend/vue/vue2.html#mixins混入" class="sidebar-link">mixins混入</a></li><li class="sidebar-sub-header"><a href="/pages/frontend/vue/vue2.html#动态组件" class="sidebar-link">动态组件</a></li><li class="sidebar-sub-header"><a href="/pages/frontend/vue/vue2.html#表单元素checkbox和select双向数据绑定" class="sidebar-link">表单元素checkbox和select双向数据绑定</a></li><li class="sidebar-sub-header"><a href="/pages/frontend/vue/vue2.html#表单修饰符" class="sidebar-link">表单修饰符</a></li><li class="sidebar-sub-header"><a href="/pages/frontend/vue/vue2.html#vue插槽的使用" class="sidebar-link">vue插槽的使用</a></li><li class="sidebar-sub-header"><a href="/pages/frontend/vue/vue2.html#vue自动化全局注册组件" class="sidebar-link">vue自动化全局注册组件</a></li><li class="sidebar-sub-header"><a href="/pages/frontend/vue/vue2.html#vue动画-过渡" class="sidebar-link">vue动画&amp;过渡</a></li><li class="sidebar-sub-header"><a href="/pages/frontend/vue/vue2.html#babel-polyfill" class="sidebar-link">Babel-polyfill</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>js</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>css</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/pages/frontend/vuepress/vuepress.html" class="sidebar-link">vueperss博客搭建</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="响应式原理"><a href="#响应式原理" class="header-anchor">#</a> 响应式原理</h2> <h3 id="什么是响应式"><a href="#什么是响应式" class="header-anchor">#</a> 什么是响应式</h3> <p>从前端的角度可以简单的理解为：当数据发生变化时，页面的DOM也随之发生改变，并且整个数据模型在js中就是一个对象。也就是当你通过js改变数据模型中的数据时，对应的引用该数据的dom也会发生改变。</p> <h3 id="object-defineproperty"><a href="#object-defineproperty" class="header-anchor">#</a> Object.defineProperty</h3> <p>要想理解vue的响应式原理，我们首先得了解<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty" target="_blank" rel="noopener noreferrer">Object.defineproperty<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>这个方法，下面结合一个问题来简单介绍一下这个方法的用法以及作用：
首先我们思考一下如何实现当我们改变一个js对象的时候，让对应的dom发生改变？首先看一下vue的常见结构。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>var app = new Vue({
  el: '#app',
  data: {
    count: 0
  },
  methods: {
    addCount() {
      this.count++
    }
  }
})

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>app<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
  {{count}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>addCount<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>点我count自增<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>那不通过vue如何实现呢，看一下下面的代码</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token comment">// 定义数据模型</span>
  <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
    count<span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> count <span class="token operator">=</span> data<span class="token punctuation">.</span>count
  <span class="token comment">// 获取dom元素</span>
  <span class="token keyword">const</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.btn'</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> input <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.inp'</span><span class="token punctuation">)</span>
  <span class="token comment">// 绑定事件修改数据</span>
  btn<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    data<span class="token punctuation">.</span>count<span class="token operator">++</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// 对数据模型进行劫持</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token string">'count'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    configurable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    enumerable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> count
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      count<span class="token operator">++</span>
      <span class="token comment">// 当监测到数据被修改时，改变dom元素</span>
      input<span class="token punctuation">.</span>value <span class="token operator">=</span> count
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>input <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">'inp'</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>button <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">'btn'</span><span class="token operator">&gt;</span>点我count自增<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>具体案例请移步<a href="https://codepen.io/wujiawei/pen/rNWeXgP" target="_blank" rel="noopener noreferrer">Object.defineProperty劫持数据并双向绑定<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，Object.defineProperty第一个参数是被劫持的对象，第二个参数是需要劫持的属性,第三个参数是一个对象，本例中主要运用到了get和set。当我们在事件回调中执行<code>data.count++</code>时就会触发<code>set</code>方法，在set方法中就可以执行一些需要的操作。
对比两个案例就可以发现区别就是vue的数据劫持以及dom操作都是内部完成的，而我们的方法是自己手动修改的。看完这个案例之后，我们就来结合代码详细分析一下vue响应式原理。</p> <h3 id="vue响应式原理"><a href="#vue响应式原理" class="header-anchor">#</a> vue响应式原理</h3> <p>首先看一下官网的解释：</p> <p>当你把一个普通的 JavaScript 对象传入 Vue 实例作为 data 选项，Vue 将遍历此对象所有的 property，并使用 Object.defineProperty 把这些 property 全部转为 getter/setter。Object.defineProperty 是 ES5 中一个无法 shim 的特性，这也就是 Vue 不支持 IE8 以及更低版本浏览器的原因。</p> <p>这些 getter/setter 对用户来说是不可见的，但是在内部它们让 Vue 能够追踪依赖，在 property 被访问和修改时通知变更。这里需要注意的是不同浏览器在控制台打印数据对象时对 getter/setter 的格式化并不同，所以建议安装 vue-devtools 来获取对检查数据更加友好的用户界面。</p> <p>每个组件实例都对应一个 watcher 实例，它会在组件渲染的过程中把“接触”过的数据 property 记录为依赖。之后当依赖项的 setter 触发时，会通知 watcher，从而使它关联的组件重新渲染。
<img src="https://user-gold-cdn.xitu.io/2018/2/8/1617554b425a3431?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="avatar"></p> <p>将上图分为三个阶段：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>1.初始化init阶段：主要用来初始化实例并劫持数据

2.解析dom，mount阶段：主要用来解析试图，并收集对应依赖，添加订阅者watcher

3.更新re-render阶段：当数据发生改变，通过watcher改变试图
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>下面我们结合代码来看：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>数据的双向绑定<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token comment">// 先定义一个简单的vue类</span>
  <span class="token keyword">class</span> <span class="token class-name">EasyVue</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// options为初始化实例时传入的参数对象</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$options <span class="token operator">=</span> options
      <span class="token keyword">this</span><span class="token punctuation">.</span>$data <span class="token operator">=</span> options<span class="token punctuation">.</span>data
      <span class="token keyword">this</span><span class="token punctuation">.</span>$el <span class="token operator">=</span> options<span class="token punctuation">.</span>el
      <span class="token comment">// 初始化依赖收集器 具体作用下面再讲</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$deps <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
      <span class="token comment">// 1阶段：劫持数据（这里主要对data进行劫持，计算属性和观察属性暂不做处理）</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">)</span>
      <span class="token comment">// 2阶段：解析dom，根据视图将订阅者wather添加到对应依赖中</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 1阶段</span>
    <span class="token function">observe</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> val
      <span class="token comment">// 遍历劫持</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 收集data中的每个属性为依赖，并且初始化</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$deps<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token comment">// 获取属性值</span>
        val <span class="token operator">=</span> data<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
        <span class="token comment">// 递归劫持 这里只做了简单判断</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> val <span class="token operator">===</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">const</span> deps <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$deps<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
        Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
          configurable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          enumerable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 访问该属性的时候返回对应属性值</span>
            <span class="token keyword">return</span> val
          <span class="token punctuation">}</span>
          <span class="token function">set</span><span class="token punctuation">(</span>newVal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>val <span class="token operator">!==</span> newVal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token comment">// 重新赋值，</span>
              val <span class="token operator">=</span> newVal
              <span class="token comment">// 数据变化后，遍历依赖收集器，通知对应订阅者watcher更新视图</span>
              <span class="token comment">// 至于watcher是什么，下面再讲</span>
              deps<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">watcher</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                watcher<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
              <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 2阶段</span>
    <span class="token function">compile</span><span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 获取对应dom节点</span>
      <span class="token keyword">const</span> node <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span>
      <span class="token comment">// node.children不是真正的数组，需要转换</span>
      <span class="token keyword">const</span> children <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>children<span class="token punctuation">)</span>
      <span class="token comment">// 遍历子节点</span>
      children<span class="token punctuation">.</span><span class="token function">foEach</span><span class="token punctuation">(</span><span class="token parameter">childNode</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// 递归解析dom</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>childNode<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span>childNode<span class="token punctuation">.</span>children<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 解析具有v-text指令的dom</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>childNode<span class="token punctuation">.</span><span class="token function">hasAttribute</span><span class="token punctuation">(</span><span class="token string">'v-text'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 获取属性值（这个属性值是data上的某一给属性，也就是需要收集的依赖）</span>
          <span class="token keyword">const</span> key <span class="token operator">=</span> childNode<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'v-text'</span><span class="token punctuation">)</span>
          <span class="token comment">// 给对应依赖添加对应的订阅者watcher</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>$deps<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Watcher</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> childNode<span class="token punctuation">,</span> <span class="token string">'innerHTML'</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 解析具有v-model指令并且是input框的dom</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>childNode<span class="token punctuation">.</span><span class="token function">hasAttribute</span><span class="token punctuation">(</span><span class="token string">'v-model'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> childNode<span class="token punctuation">.</span>tagName <span class="token operator">===</span> <span class="token string">'INPUT'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> key <span class="token operator">=</span> childNode<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'v-model'</span><span class="token punctuation">)</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>$deps<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Watcher</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> childNode<span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token comment">// v-model为vue的语法糖，手动绑定事件</span>
          childNode<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// 修改data中的数据 会触发被劫持属性的set方法</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> childNode<span class="token punctuation">.</span>value
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">class</span> <span class="token class-name">Watcher</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">vm<span class="token punctuation">,</span> el<span class="token punctuation">,</span> attr<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// vue组件实例</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>vm <span class="token operator">=</span> vm
      <span class="token comment">// dom元素</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>el <span class="token operator">=</span> el
      <span class="token comment">// dom元素属性</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>attr <span class="token operator">=</span> attr
      <span class="token comment">// data中的某一数据</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>key <span class="token operator">=</span> key
      <span class="token comment">// 初始化</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updata</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>el<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>attr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>vm<span class="token punctuation">.</span>$data<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>key<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 创建组件实例</span>
  <span class="token keyword">const</span> vue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EasyVue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    el<span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
    data<span class="token operator">:</span> <span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token string">'张三'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br></div></div><p>通过上面的代码我们可以看出，首先在observe中劫持data中的所有数据，转化为get以及set，这样可以在数据改变时进行视图的更新，并且通过dep将每一个数据作为依赖收集起来；然后通过解析器解析dom上的指令，进行事件绑定并且为每一个依赖添加对应的watcher订阅者；最后当数据改变时，触发了set方法，然后dep中对应的依赖通知watcher进行视图的改变，这就是vue响应式的原理。
具体的案例请移步<a href="https://codepen.io/wujiawei/pen/RwGXBZQ?editors=1111" target="_blank" rel="noopener noreferrer">vue响应式原理<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p>下面是对响应式的一些补充，对数组的操作以及添加新属性的方法：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">const</span> arrayPrototype <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype
  <span class="token keyword">const</span> newPrototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>arrayPrototype<span class="token punctuation">)</span>
  <span class="token keyword">const</span> methods <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'push'</span><span class="token punctuation">,</span><span class="token string">'pop'</span><span class="token punctuation">,</span><span class="token string">'shift'</span><span class="token punctuation">,</span><span class="token string">'unshift'</span><span class="token punctuation">,</span><span class="token string">'splice'</span><span class="token punctuation">,</span><span class="token string">'sort'</span><span class="token punctuation">,</span><span class="token string">'reverse'</span><span class="token punctuation">]</span>
  methods<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">method</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>newPrototype<span class="token punctuation">,</span> method<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      configurable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      enumerable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'监听到了数组变化'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> arrayPrototype<span class="token punctuation">[</span>method<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      enumerable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      configurable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> val
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">set</span><span class="token punctuation">(</span>newVal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>newVal <span class="token operator">===</span> val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span>
        <span class="token punctuation">}</span>
        val <span class="token operator">=</span> newVal
        <span class="token function">observer</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">observer</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> obj <span class="token operator">!==</span> <span class="token string">'object'</span> <span class="token operator">||</span> obj <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 如果监听的值不是对象直接返回</span>
      <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&quot;[object Array]&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      obj<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> newPrototype
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 循环监听对象的每一个属性</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">observer</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">,</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 为obj设置新的属性时，创建新的监听  对标vue this.$set方法</span>
  <span class="token keyword">function</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'xh'</span><span class="token punctuation">,</span> bro<span class="token operator">:</span> <span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'xz'</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
  <span class="token function">observer</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br></div></div><p>通过以上的分析，应该可以初步理解vue的响应式原理了，更加具体的可以看vue的源码。</p> <h2 id="计算属性computed"><a href="#计算属性computed" class="header-anchor">#</a> 计算属性computed</h2> <p>计算属性computed：</p> <p>当计算属性的依赖发生变化时，那么该计算属性就会发生改变，计算属性的结果是函数的返回值。</p> <p>使用方法：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>computed：<span class="token punctuation">{</span>
 <span class="token function">totalPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> num<span class="token operator">*</span>salePrice<span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>我们只需要通过 {{}} 或者 v-html 绑定就可以使用该计算属性。</p> <p>计算属性vs方法：</p> <p>当我们要使用的某个值受很多条件影响时，我们可以使用计算属性。
当然我们也可以通过在{{}}中用调用方法的形式来代替计算属性。
但是计算属性是具有缓存效果的，也就是说计算属性的依赖未发生变化时，我们多次访问这个计算属性，并不会重复执行涉及到的函数。
但是使用调用方法的形式则会增加很多不必要的计算。</p> <p>计算属性vs侦听属性：</p> <p>侦听属性watch，侦听属性watch可以检测data中的数据变化，并执行相应函数。
当我们要使用的数据随着其他数据变化而响应时，我们也可以使用watch来实现。</p> <p>使用方法：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>watch： <span class="token punctuation">{</span>

 <span class="token function">money</span><span class="token punctuation">(</span><span class="token parameter">newmoney<span class="token punctuation">,</span>oldmoney</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  逻辑代码；

 <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>相比之下，在普通的逻辑下，我们用计算属性可能更加方便，但是在涉及到异步请求等异步操作时，我们用侦听器watch可能更加方便来实现我们的需求。</p> <h2 id="v-for列表循环key属性"><a href="#v-for列表循环key属性" class="header-anchor">#</a> v-for列表循环key属性</h2> <p>关于key：在我们使用v-for列表渲染时，尽量给循环的DOM节点带上key属性，key相当于是这个节点的唯一标识。
避免我们在改变列表后页面渲染出现问题，尤其是涉及到表单元素时。</p> <p>我们可以在列表渲染中使用方法，v-for=&quot;num in filter(nums)&quot;，filter就是一个方法。</p> <h2 id="动态修改数组与对象"><a href="#动态修改数组与对象" class="header-anchor">#</a> 动态修改数组与对象</h2> <p>关于想直接修改一个已经渲染在页面上的数组或者对象时：
例如现在有一个数组arr = ['a','b','c']和一个对象obj = {name: '毛不易'}，
如果我们直接在方法中直接通过索引的方式修改或者为数组增加某一项，或者试图为对象增添新的属性，
那么在渲染的时候并不会直接渲染成我们期望的值。</p> <p>对此，vue提供了Vue.set(arr,index,value)的方式修改数组或添加的某一项，
Vue.set(obj,key,value)的方式为对象新增属性。</p> <p>当我们要为对象增添不止一个属性时：</p> <p>我们可以通过 this.obj = Object.assign({},this.obj,{key: value,key: value}) 的方式为对象新增多个属性。</p> <p>当我们用Vue.set时我们需要导入Vue ，即 import Vue from 'vue'。</p> <p>Vue.set 也可以写成  this.$set，this就是当前vm实例。</p> <h2 id="修饰符"><a href="#修饰符" class="header-anchor">#</a> 修饰符</h2> <p>一、事件修饰符：</p> <p>.prevent：阻止默认事件，比如当在textarea中按下回车键会自动换行，
这时我们通过@keydown.enter.prevent就可以阻止默认的换行行为。</p> <p>.stop：阻止事件冒泡，当子盒子与父盒子重叠且均绑定了某一事件，比如点击事件，那么当我们点击子盒子时，该事件会从内向外冒泡。
那通过给自盒子的点击事件绑定.stop，即@click.stop这样就可以阻止事件向外冒泡。</p> <p>.capture：采用事件捕获机制，当某个元素绑定了这个事件修饰符，那么该元素上的这个事件会被最先触发。</p> <p>.self：当某个元素的事件采用了这个事件修饰符，那么只有当触发元素是自己本身时，该事件才会触发，不会受到事件冒泡影响而触发。</p> <p>二、按键修饰符：</p> <p>.enter、.tab、.delete、.esc、.space、.up、.down、.left、.right</p> <p>三、系统修饰符：可以让我们在按下这些键并同时进行点击或按键事件时才触发某个事件</p> <p>.ctrl、.alt、.shift、.meta       例如：@click.ctrl   或者  @keydown.ctrl.enter</p> <p>.exact修饰符，在系统修饰符后再加上该修饰符表示
有且只有被指定的修饰符按键被按下才可以触发某事件，
若直接在事件后加该修饰符表示没有任何修饰符按键被按下才可以触发事件。</p> <p>四、鼠标按钮修饰符</p> <p>.left、.right、.middle</p> <h2 id="vue单元测试"><a href="#vue单元测试" class="header-anchor">#</a> vue单元测试</h2> <p>vue单元测试：</p> <p>1.为什么要进行单元测试：前端经常会修改js功能，会造成代码可能会出现其他问题，那么我们需要去测试，但是我们手动去测不方便；或者说多人开发代码不容易阅读；后期维护迭代重构也不方便，所以要写前端单元测试。</p> <p>2.什么是单元测试：在vue中，一个组件就可以作为一个单元，我们测试就以组件为单元来进行测试。</p> <p>3.TDD &amp; BDD</p> <p>1）TDD（测试驱动开发），在开发之前先编写测试用例代码，然后写代码功能将测试用例跑通，则代表功能完善。用例描述出了哪些功能，很好的诠释了代码即文档。</p> <p>2）BDD（行为驱动开发），开发之前，人员一起合作考虑需求，在开发之前完成需求保证功能正确性。</p> <p>4.测试工具 mocha+chai/jest</p> <p>mocha：测试框架，用于跑测试用例；chai：断言库，用于判断功能是否正确</p> <p>jest：测试框架。</p> <p>karma：支持将运行代码放到浏览器去测；但是现在的node环境，可能只需要测试功能和页面显示对不对，所以我们可以不用karma，用jsdom，这样的好处是不限制只能在浏览器上测试，可以在node中来操作显示dom。</p> <p>5.如何写测试用例：</p> <p>1.首先创建vue项目 要选择unit test这一项</p> <p>2.package.json中描述了如何启动测试 &quot;test:unit&quot;: &quot;vue-cli-service test:unit&quot;</p> <p>3.传统测试我们可能通过在代码中写console.log()的方式来测试我们的逻辑代码运行是否正确，
但是这种方法繁琐且项目上线后测试代码要删除。</p> <p>4.所以我们通过写测试用例的方法来经行单元测试，通常我们将测试的js文件放在tests下的unit目录下，
且取名通常以xxx.spec.js结尾。</p> <p>5.基本测试用例写法</p> <p>//引入要测试的方法</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code> <span class="token keyword">import</span> <span class="token punctuation">{</span>parser<span class="token punctuation">,</span>stringfy<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./../../code/parser.js'</span>

 <span class="token comment">//引入断言库</span>

 <span class="token keyword">import</span> <span class="token punctuation">{</span>expect<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'chai'</span>

 <span class="token comment">// 将测试用例用describe包裹起来,可以将测试用例分类,describe相当于测试用例套件</span>

 <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'测试parser的'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>

  <span class="token comment">//一个it就是一个测试用例</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'测试parser是否靠谱'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

   <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">parser</span><span class="token punctuation">(</span><span class="token string">'name=wjw'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span>be<span class="token punctuation">.</span>deep<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'wjw'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token punctuation">}</span><span class="token punctuation">)</span>

 <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>6.引入测试工具vue-test-utils，可以让我们对组件进行测试，我们的测试一般只关心输入和输出，即用户行为或者data中数据的变化对最终页面渲染或者某一事件的触发所产生的结果。下面测试工具的基本用法：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code> <span class="token keyword">import</span> HelloWorld <span class="token keyword">from</span> <span class="token string">'./../../src/components/HelloWorld.vue'</span><span class="token punctuation">;</span>

 <span class="token keyword">import</span> <span class="token punctuation">{</span>expect<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'chai'</span><span class="token punctuation">;</span>

 <span class="token comment">//导入测试工具</span>

 <span class="token keyword">import</span> <span class="token punctuation">{</span>mount<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>

 <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'测试HelloWorld.vue'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'测试传递属性后是否显示正常值'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

   <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>HelloWorld<span class="token punctuation">,</span><span class="token punctuation">{</span>

    propsData<span class="token operator">:</span> <span class="token punctuation">{</span>

     msg<span class="token operator">:</span> <span class="token string">'hello'</span>

    <span class="token punctuation">}</span>

   <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// wrapper.setProps({msg: 'hello'});</span>

   <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'h1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span>be<span class="token punctuation">.</span><span class="token function">contain</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span>

  <span class="token punctuation">}</span><span class="token punctuation">)</span>

 <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>7.使用shallowMount，对于某个包含很多子组件的组件来说，通过shallowMount挂载该组件并不会渲染其子组件，从而可以提升测试速度。</p> <p>8.父组件给子组件传值 注意props:['num']  要加引号  或者props: {num: Number}写对象的形式。子组件触发父组件方法：在子组件绑定的事件处理函数中用this.$emit('事件名')（该事件绑定在父组件上）来触发父组件的事件。</p> <p>当我们测试时，需要在测试中通过子组件触发父组件事件测试的 具体写法如下：</p> <p>const wrapper = mount(HelloWorld);</p> <p>const numNode = wrapper.find(counter).find('.num');</p> <p>expect(parseInt(numNode.text())).to.be.equal(0);</p> <p>wrapper.find(counter).vm.$emit('increase');</p> <p>expect(parseInt(numNode.text())).to.be.equal(1);</p> <p>counter为HelloWorld的子组件，我们在测试文件中需要导入这个子组件，然后通过wrapper.find(counter)来找到这个子组件  注意不要加''</p> <h2 id="mixins混入"><a href="#mixins混入" class="header-anchor">#</a> mixins混入</h2> <p>mixins可以用来分发组件中的可复用功能，可以避免写许多重复的功能。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    <span class="token keyword">var</span> mixin <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token comment">//混入对象中的数据如果和组件中的数据重复，则取组件中的数据</span>
      <span class="token function-variable function">data</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
          message<span class="token operator">:</span> <span class="token string">'hello'</span><span class="token punctuation">,</span>
          foo<span class="token operator">:</span> <span class="token string">'abc'</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">//钩子函数会被合并成一个数组，都会被调用，而且混入对象的钩子函数先触发。</span>
      <span class="token function-variable function">created</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'混入对象的钩子被调用'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">//methods、components等等对象格式的选项，如果键名和组件中的重复，则以组件中的为准。</span>
      methods<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">foo</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">conflicting</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'from mixin'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">//在组件中使用mixins：则我可以在该组件中通过this. 获取到混合对象mixin中的任何数据方法与钩子函数。</span>
    <span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      mixins<span class="token operator">:</span> <span class="token punctuation">[</span>mixin<span class="token punctuation">]</span><span class="token punctuation">,</span>
      methods<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">bar</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'bar'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">conflicting</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'from self'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h2 id="动态组件"><a href="#动态组件" class="header-anchor">#</a> 动态组件</h2> <p>动态组件：</p> <p>我们可以通过<code>&lt;component :is=&quot;currentCom&quot;&gt;&lt;/component&gt;</code>来实现组件的动态切换</p> <p>假设我们有三个组件comA，comB，comC</p> <p>我们通过切换实例的currentCom的值分别为comA，comB，comC就可以在这三个组件之间切换。</p> <p>keep-alive：</p> <p>当我们使用动态组件时，当组件切换的时候，每次切换组件都会重新渲染组件，</p> <p>但是有时我们并不想组件重新渲染，希望组件状态缓存，这时就可以用keep-alive标签将动态组件包裹起来。</p> <p><code>&lt;keep-alive&gt;&lt;/keep-alive&gt;</code></p> <p>属性：include：字符串或者正则表达式。只有名称匹配的组件会被缓存；
exclude：字符串或者正则，名称匹配的组件不会被缓存。</p> <p>当组件在keep-alive中切换时，activated和deactivated两个生命周期钩子函数会被触发。</p> <p>当我们切换出被keep-alive包裹的组件时，deactivated会被触发，切进时activated会被触发，而且由于被缓存了，created和mounted不会被触发。</p> <h2 id="表单元素checkbox和select双向数据绑定"><a href="#表单元素checkbox和select双向数据绑定" class="header-anchor">#</a> 表单元素checkbox和select双向数据绑定</h2> <p>当涉及到多个复选框的选择时，我们可以将复选框的v-model绑定为一个数组，并且为复选框绑定value属性，这样当我们选中这个复选框时，该复选框的value值就会被添加进数组中。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkbox<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>star in stars<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>star<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkbox<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkBox<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>star<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>star<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">:for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>star<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{star}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>checked names: {{checkBox}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
// checkBox: []
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>当下拉框选择时，选中某一项的value的属性将会是selected的值</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>selected<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">disabled</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>请选择<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>A<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>B<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>B<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>C<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>C<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>selected: ''   selected的默认值为空，所以会默认选中value为空的那么选项。</p> <p>当涉及到下拉多选时，可以把selected绑定为数组。同样被选择的选项的value值会被添加进数组中。</p> <h2 id="表单修饰符"><a href="#表单修饰符" class="header-anchor">#</a> 表单修饰符</h2> <p>给表单绑定v-model时，我们可以给v-model加表单修饰符，共有三种：</p> <p>.number 将用户在input中的输入转为number类型，
但是如果用户输入字母开始则仍然输出字符串；如果数字开始，则限制输出只为数字。</p> <p>.trim 将用户在input中的输入的前后空格去除</p> <p>.lazy 表示当用户输入时不直接产生效果，也就是将触发条件input变为了change</p> <h2 id="vue插槽的使用"><a href="#vue插槽的使用" class="header-anchor">#</a> vue插槽的使用</h2> <p>vue插槽的使用：</p> <p>1.在组件中添加<code>&lt;slot&gt;&lt;/slot&gt;</code>标签，然后在使用该组件的时候，组件标签内的任何节点都会被渲染到这个slot标签中。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>    // 组件MySlot：
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myslot<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>欢迎使用插槽<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
    
    // 其他组件使用组件MySlot：
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-slot</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>我会被渲染到MySlot组件的slot标签中<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-slot</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>2.可以为<code>&lt;slot&gt;&lt;/slot&gt;</code>标签添加默认内容，当我们在使用组件时没有为插槽提供内容，则显示默认值</p> <p><code>&lt;slot&gt;我是默认值&lt;/slot&gt;</code></p> <p>3.给插槽命名，就可以添加多个插槽  具名插槽</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>    // 我们在组件中添加这些具名插槽：
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>header<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>header</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>main</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span>我是后备内容，如果使用这个组件时未给我值，那么我就会显示<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>main</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>footer</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>footer<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>footer</span><span class="token punctuation">&gt;</span></span>
    
    // 在使用组件的时候，在组件标签之间这么写：
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name"><span class="token namespace">v-slot:</span>header</span><span class="token punctuation">&gt;</span></span>
     我是渲染头部插槽的
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- &lt;div&gt;
    	不命名则默认v-slot:default
    &lt;/div&gt; --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name"><span class="token namespace">v-slot:</span>default</span><span class="token punctuation">&gt;</span></span>
     这样写也可以
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name"><span class="token namespace">v-slot:</span>footer</span><span class="token punctuation">&gt;</span></span>
     我是渲染底部插槽的
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>4.作用域插槽：可以使父组件中插槽的内容访问到子组件中的数据</p> <p>通过给子组件的slot插槽绑定属性，然后就可以在父组件使用子组件时获取到子组件的数据</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token attr-name">:person</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>person<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>  // 这个person是在子组件的作用域中的
    
    // 然后在父组件使用时：slotProps是自己取得名字，取什么都可以
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name"><span class="token namespace">v-slot:</span>dafault</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>slotProps<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
     {{slotProps.person}}
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
    // 当用在默认插槽上时 :default 可以省略，但是当出现具名插槽时 :default 还是不能省略
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="vue自动化全局注册组件"><a href="#vue自动化全局注册组件" class="header-anchor">#</a> vue自动化全局注册组件</h2> <p>我们有时会用到一些经常需要复用的组件，但是内容又很少，这时我们可以通过自动化注册全局组件来避免在许多组件中大量导入这些小的导入组件或者js文件。</p> <p>具体做法：在main.js中进行编写：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    <span class="token keyword">import</span> upperFirst <span class="token keyword">from</span> <span class="token string">'lodash/upperFirst'</span>
    <span class="token keyword">import</span> camelCase <span class="token keyword">from</span> <span class="token string">'lodash/camelCase'</span>
    <span class="token keyword">const</span> requireComponent <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span>
     <span class="token comment">//需要自动化全局注册的组件目录</span>
     <span class="token string">'./components/baseComponents'</span><span class="token punctuation">,</span>
     <span class="token comment">//是否查询其子目录</span>
     <span class="token boolean">false</span><span class="token punctuation">,</span>
     <span class="token comment">//匹配组件名的正则表达式</span>
     <span class="token operator">/</span>Base<span class="token punctuation">[</span><span class="token constant">A</span><span class="token operator">-</span><span class="token constant">Z</span><span class="token punctuation">]</span>\w<span class="token operator">+</span>\<span class="token punctuation">.</span><span class="token punctuation">(</span>vue<span class="token operator">|</span>js<span class="token punctuation">)</span>$<span class="token operator">/</span>
    <span class="token punctuation">)</span>
    requireComponent<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">fileName</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
     <span class="token comment">//获取组件配置</span>
     <span class="token keyword">const</span> componentConfig <span class="token operator">=</span> <span class="token function">requireComponent</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token comment">//获取组件的PascalCase命名</span>
     <span class="token keyword">const</span> componentName <span class="token operator">=</span> <span class="token function">upperFirst</span><span class="token punctuation">(</span>
     <span class="token comment">// 剥去文件名开头的 `'./` 和结尾的扩展名</span>
      <span class="token function">camelCase</span><span class="token punctuation">(</span>
       fileName<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\.\/(.*)\.\w+$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">'$1'</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
     <span class="token punctuation">)</span>
     <span class="token comment">//全局组件注册</span>
     Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>
      componentName<span class="token punctuation">,</span>
      componentConfig<span class="token punctuation">.</span>default <span class="token operator">||</span> componentConfig
     <span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h2 id="vue动画-过渡"><a href="#vue动画-过渡" class="header-anchor">#</a> vue动画&amp;过渡</h2> <p>1.单元素或组件的过渡：将要过渡的元素或者组件用<code>&lt;transition&gt;&lt;/transition&gt;</code>标签包裹，过渡元素需要与v-show v-if结合使用。可以给transition标签添加一个name属性。</p> <p>2.过渡类名：</p> <p>v-enter、v-enter-acitve、v-enter-to、v-leave、v-leave-active、v-leave-to</p> <p>v-enter：进入过渡的开始状态；v-enter-active：进入过渡的持续状态，一般定义过渡属性以及持续时间，运动方式等等；v-enter-to：进入过渡结束时的状态；v-leave：离开过渡的开始状态；v-leave-active：离开过渡的持续状态；v-leave-to：离开过渡结束时的状态。</p> <p>当我们给了transition标签name属性后，v就需要用name的属性值代替。</p> <p>3.动画：</p> <p>定义一个动画：通过@keyframes 动画名 {动画状态}来定义一个动画</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code>    <span class="token atrule"><span class="token rule">@keyframes</span> bounce-in</span> <span class="token punctuation">{</span>
      <span class="token selector">0%</span> <span class="token punctuation">{</span>
        <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">scale</span><span class="token punctuation">(</span>0<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token selector">50%</span> <span class="token punctuation">{</span>
        <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">scale</span><span class="token punctuation">(</span>1.5<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token selector">100%</span> <span class="token punctuation">{</span>
        <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">scale</span><span class="token punctuation">(</span>1<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>使用：通过css的animation属性来使用这个动画。</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code>    <span class="token selector">.bounce-enter-active</span> <span class="token punctuation">{</span>
      <span class="token property">animation</span><span class="token punctuation">:</span> bounce-in .5s<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.bounce-leave-active</span> <span class="token punctuation">{</span>
      <span class="token property">animation</span><span class="token punctuation">:</span> bounce-in .5s reverse<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>4.自定义过渡类名：</p> <p>enter-class、enter-active-class、enter-to-class、leave-class、leave-active-class、leave-to-class</p> <p>可以给transition标签添加这些自定义类名，这样就可以给这些类名绑定第三方动画库的动画。</p> <p>例如：
<code>&lt;transition name=&quot;custom-classes-transition&quot; enter-active-class=&quot;animated tada&quot; leave-active-class=&quot;animated bounceOutRight&quot;&gt;&lt;/transition&gt;</code>
其中animated tada与animated bounceOutRight是第三方动画库提供的类</p> <p>5.同时使用过渡和动画：</p> <p>1）需要动画在刷新的时候也能有效果：</p> <p>给transition标签加appear以及appear-active-class=“与enter-acitve-class相同”这两个属性；</p> <p>2）以哪一个为结束标准：
我们可以给transition设置type属性为transition或者animation来规定以哪一个为结束标准。</p> <p>3）也可以手动给结束时间：</p> <p>：duration=“毫秒单位时间”或者：duration=“{enter：毫秒时间，leave：毫秒时间}”</p> <p>6.多元素过渡：</p> <p>当涉及到两个相同标签的元素参与过渡时，我们需要给标签添加key属性来区分两个标签，否则vue只会替换内容，而不会重新渲染标签导致过渡不会生效。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    <span class="token operator">&lt;</span>transition name<span class="token operator">=</span><span class="token string">&quot;btn-act&quot;</span> mode<span class="token operator">=</span><span class="token string">&quot;out-in&quot;</span><span class="token operator">&gt;</span>
     <span class="token operator">&lt;</span>button v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;onOrOff=='on'&quot;</span> @click<span class="token operator">=</span><span class="token string">&quot;onOrOff='off'&quot;</span> key<span class="token operator">=</span><span class="token string">&quot;on&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>onOrOff<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
     <span class="token operator">&lt;</span>button v<span class="token operator">-</span><span class="token keyword">else</span> @click<span class="token operator">=</span><span class="token string">&quot;onOrOff='on'&quot;</span> key<span class="token operator">=</span><span class="token string">&quot;off&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>onOrOff<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>transition<span class="token operator">&gt;</span>
    <span class="token punctuation">.</span>btn<span class="token operator">-</span>act<span class="token operator">-</span>enter<span class="token punctuation">,</span>
    <span class="token punctuation">.</span>btn<span class="token operator">-</span>act<span class="token operator">-</span>leave<span class="token operator">-</span>to <span class="token punctuation">{</span>
     opacity<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">.</span>btn<span class="token operator">-</span>act<span class="token operator">-</span>enter<span class="token operator">-</span>active<span class="token punctuation">,</span>
    <span class="token punctuation">.</span>btn<span class="token operator">-</span>act<span class="token operator">-</span>leave<span class="token operator">-</span>active <span class="token punctuation">{</span>
     transition<span class="token operator">:</span> all <span class="token number">1</span>s<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>其中mode属性为设置过渡模式，否则两个标签的过渡会同时进行。过渡模式有in-out、out-in。</p> <p>当我们需要两个元素能够重叠需要给两个元素position：absolute；</p> <p>7.多组件过渡：</p> <p>多组件过渡不需要用到key属性，只需要用transition标签将动态组件component标签包裹起来，再配合过渡模式mode即可。</p> <h2 id="babel-polyfill"><a href="#babel-polyfill" class="header-anchor">#</a> Babel-polyfill</h2> <p>Babel不会转换新的API，而只转换新的es6语法，所以当我们在IE低版本浏览器中使用到es6涉及的新的API时，浏览器无法解析。所以我们可以引入babel-polyfill来解决这个问题。</p> <p>先安装：npm install babel-polyfill --save</p> <p>再在main.js首行导入 import 'babel-polyfill'</p> <p>vue2中：修改webpack.base.conf.js</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code> module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// entry: {</span>
  <span class="token comment">//   app: './src/main.js'</span>
  <span class="token comment">// },</span>
  entry<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'babel-polyfill'</span><span class="token punctuation">,</span> <span class="token string">'./src/main.js'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/pages/frontend/react/zujiantongxin.html" class="prev">
        函数式组件通信
      </a></span> <span class="next"><a href="/pages/frontend/js/replace.html">
        replace方法
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.824c4530.js" defer></script><script src="/assets/js/2.043a423b.js" defer></script><script src="/assets/js/14.edf7d5e1.js" defer></script>
  </body>
</html>
